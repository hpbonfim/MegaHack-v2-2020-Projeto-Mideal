function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,o=!1,c=void 0;try{for(var a,i=t[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(s){o=!0,c=s}finally{try{n||null==i.return||i.return()}finally{if(o)throw c}}return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){return function(){var e,r=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var n=_getPrototypeOf(this).constructor;e=Reflect.construct(r,arguments,n)}else e=r.apply(this,arguments);return _possibleConstructorReturn(this,e)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{SoNV:function(t,e,r){"use strict";r.r(e),r.d(e,"UserContractModule",(function(){return G}));var n,o=r("ofXK"),c=r("Wp6s"),a=r("tyNb"),i=r("PSD3"),s=r.n(i),u=r("ISmH"),l=r("aaHD"),f=r("fXoL"),b=r("k9EJ"),p=r("FXLl"),d=r("tk/3"),h=((n=function(t){_inherits(r,t);var e=_createSuper(r);function r(t){var n;return _classCallCheck(this,r),(n=e.call(this,t)).API_URL="function/encrypt",n}return r}(p.a)).\u0275fac=function(t){return new(t||n)(f.Wb(d.b))},n.\u0275prov=f.Jb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),y=r("4jKo"),v=r("w+uN"),m=r("mrSG"),g=function t(){_classCallCheck(this,t)},C=r("3Pt+"),_=r("cYo0"),S=r("XiUz"),k=r("bTqV"),O=r("NFeN"),w=r("kmnG"),I=r("qFsG");function R(t,e){if(1&t&&(f.Sb(0,"div"),f.Sb(1,"mat-form-field",5),f.Sb(2,"mat-label"),f.vc(3),f.Rb(),f.Ob(4,"input",6),f.Sb(5,"mat-error"),f.vc(6,"Campo obrigat\xf3rio"),f.Rb(),f.Rb(),f.Rb()),2&t){var r=e.$implicit;f.Bb(3),f.wc(r.label),f.Bb(1),f.hc("formControlName",r.controlName)}}function N(t,e){if(1&t&&(f.Sb(0,"div"),f.uc(1,R,7,2,"div",3),f.Rb()),2&t){var r=e.$implicit;f.Bb(1),f.hc("ngForOf",r.controls)}}var T,P=((T=function(){function t(e){var r=this;_classCallCheck(this,t),this.contractService=e,this.contract=new g,this.setContractIsFilled=new f.n,this.serviceContract=Object.assign({},l.a),this.handleSubmit=function(){Object(_.a)(r.form),r.form.invalid||(r.blocks.forEach((function(t){var e=t.controls.map((function(t){return{key:"{".concat(t.controlName,":").concat(t.label,"}"),value:r.form.get(t.controlName).value}}));r.contractService.fillBlock(t.blockTitle,e)})),r.setContractIsFilled.emit())}}return _createClass(t,[{key:"ngOnInit",value:function(){this.createForm()}},{key:"createForm",value:function(){return Object(m.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.form=new C.d({}),t.next=3,this.getContractInputs();case 3:this.blocks=t.sent,this.blocks.forEach((function(t){t.controls.forEach((function(t){e.form.addControl(t.controlName,new C.b("",C.n.required))}))}));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"getContractInputs",value:function(){var t=[];return this.contract.blocks.forEach((function(e){var r=e.description.match(/\{([^}]+)\}/g);if(r){var n=r.map((function(t){var e=_slicedToArray(t.replace(/\{|\}/g,"").split(":"),2);return{controlName:e[0],label:e[1]}}));t.push({blockTitle:e.title,controls:n})}})),t}}]),t}()).\u0275fac=function(t){return new(t||T)(f.Nb(b.a))},T.\u0275cmp=f.Hb({type:T,selectors:[["app-contract-infos"]],inputs:{contract:"contract"},outputs:{setContractIsFilled:"setContractIsFilled"},decls:11,vars:2,consts:[["fxLayout","column","fxLayoutAlign","start stretch"],[1,"w-100",3,"formGroup"],["fxLayout","column"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","accent",1,"btn-accent",3,"click"],["appearance","outline","color","primary",1,"w-100"],["type","text","ngDefaultControl","","matInput","",3,"formControlName"]],template:function(t,e){1&t&&(f.Sb(0,"div",0),f.Sb(1,"strong"),f.vc(2,"Informa\xe7\xf5es do contrato:"),f.Rb(),f.Ob(3,"br"),f.Sb(4,"form",1),f.Sb(5,"div",2),f.uc(6,N,2,1,"div",3),f.Rb(),f.Rb(),f.Sb(7,"button",4),f.ac("click",(function(){return e.handleSubmit()})),f.vc(8," Visualizar contrato "),f.Sb(9,"mat-icon"),f.vc(10,"forward"),f.Rb(),f.Rb(),f.Rb()),2&t&&(f.Bb(4),f.hc("formGroup",e.form),f.Bb(2),f.hc("ngForOf",e.blocks))},directives:[S.c,S.b,C.o,C.k,C.e,o.i,k.a,O.a,w.b,w.e,I.a,C.a,C.j,C.c,w.a],styles:[""]}),T),j=r("/v5Z");function A(t,e){if(1&t&&f.Ob(0,"app-contract-card",5),2&t){var r=f.cc();f.hc("contract",r.model)("selected",!0)}}function F(t,e){if(1&t){var r=f.Tb();f.Sb(0,"app-contract-infos",6),f.ac("setContractIsFilled",(function(){return f.nc(r),f.cc().filledContract=!0})),f.Rb()}if(2&t){var n=f.cc();f.hc("contract",n.contract)}}function x(t,e){if(1&t){var r=f.Tb();f.Sb(0,"app-contract-generator",7),f.ac("handleSubmit",(function(){return f.nc(r),f.cc().encryptContract()}))("goBack",(function(){return f.nc(r),f.cc().filledContract=!1})),f.Rb()}}var L,B,E,D=[{path:"",component:(L=function(){function t(e,r,n,o,c){var a=this;_classCallCheck(this,t),this.activatedRoute=e,this.contractService=r,this.contractEncryptService=n,this.userDataService=o,this.router=c,this.models=u.a,this.contract=Object.assign({},l.a),this.encryptContract=function(){var t=a.contractService.getContract(),e=a.userDataService.getUserData(),r=e.phoneNumber,n=e.stateCode,o=e.fullName,c=e.countryCode,i=e._id,u={fullName:o,payload:JSON.stringify(t),phoneNumber:"".concat(c).concat(n).concat(r)};a.contractEncryptService.post(u).subscribe((function(e){a.saveContract(t,e._id,i),s.a.fire("Sucesso","Contrato enviado com sucesso! Foi enviado uma mensagem de texto a todas as partes envolvida com a senha de acesso para acompanhamento","success").then((function(){a.goToMyContracts()}))}))}}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this.activatedRoute.snapshot.params.id;this.fillModel(t)}},{key:"saveContract",value:function(t,e,r){var n=Object.assign({},t);n.title=this.getOnlyText(n.title),n.description=this.getOnlyText(n.description),n.id=e,n.userId=r,delete n.blocks,this.contractService.createContract(n)}},{key:"fillModel",value:function(t){this.model=u.a.find((function(e){return e.id===+t}))}},{key:"goToMyContracts",value:function(){this.router.navigate(["user-shell"],{queryParams:{goTo:"myContracts"}})}},{key:"getOnlyText",value:function(t){var e=t.indexOf("<strong>"),r=t.indexOf("</strong>");return t.substring(e,r)}}]),t}(),L.\u0275fac=function(t){return new(t||L)(f.Nb(a.a),f.Nb(b.a),f.Nb(h),f.Nb(y.a),f.Nb(a.b))},L.\u0275cmp=f.Hb({type:L,selectors:[["app-user-contract"]],decls:5,vars:3,consts:[[1,"content"],[1,"card"],[3,"contract","selected",4,"ngIf"],[3,"contract","setContractIsFilled",4,"ngIf"],[3,"handleSubmit","goBack",4,"ngIf"],[3,"contract","selected"],[3,"contract","setContractIsFilled"],[3,"handleSubmit","goBack"]],template:function(t,e){1&t&&(f.Sb(0,"div",0),f.Sb(1,"div",1),f.uc(2,A,1,2,"app-contract-card",2),f.Rb(),f.uc(3,F,1,1,"app-contract-infos",3),f.uc(4,x,1,0,"app-contract-generator",4),f.Rb()),2&t&&(f.Bb(2),f.hc("ngIf",e.model),f.Bb(1),f.hc("ngIf",!e.filledContract),f.Bb(1),f.hc("ngIf",e.filledContract))},directives:[o.j,v.a,P,j.a],styles:[".container[_ngcontent-%COMP%]{height:100vh;background-color:#e5e5e5}.content[_ngcontent-%COMP%]{padding:20px}"]}),L)}],M=((B=function t(){_classCallCheck(this,t)}).\u0275mod=f.Lb({type:B}),B.\u0275inj=f.Kb({factory:function(t){return new(t||B)},imports:[[a.e.forChild(D)],a.e]}),B),H=r("PCNd"),G=((E=function t(){_classCallCheck(this,t)}).\u0275mod=f.Lb({type:E}),E.\u0275inj=f.Kb({factory:function(t){return new(t||E)},imports:[[o.b,M,H.a,c.a]]}),E)}}]);